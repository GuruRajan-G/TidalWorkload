CLS
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
$form= New-Object System.Windows.Forms.Form
$form.Text="Tidal Extractor"
$form.Size = New-Object System.Drawing.Size(400,300)
$form.StartPosition ="CenterScreen"

$textboxes= New-Object System.Collections.Generic.List[System.Windows.Forms.TextBox]

$label3= New-Object System.Windows.Forms.Label
$label3.Text="TIDALAPI"
$label3.Location=New-Object System.Drawing.Point(10,20)
$label3.Size = New-Object System.Drawing.Size(80,20)
$form.Controls.Add($label3)

$combobox= New-Object System.Windows.Forms.ComboBox
$combobox.Text="TIDALAPI"
$combobox.Location=New-Object System.Drawing.Point(100,20)
$combobox.Size = New-Object System.Drawing.Size(200,20)
$combobox.DropDownStyle = [System.Windows.Forms.ComboBoxStyle]::DropDownList
$combobox.Items.Add("https://tidalglddeva.internal.das/api/tes-6.5/postbody")
$combobox.Items.Add("https://tidalglda.internal.das/api/tes-6.5/postbody")
$combobox.Items.Add("https://tidalplat.internal.das/api/tes-6.5/postbody")
$combobox.Items.Add("https://tidaldeva.internal.das/api/tes-6.5/postbody")
$combobox.Items.Add("https://tidalqaa.internal.das/api/tes-6.5/postbody")
$combobox.Items.Add("https://tidalprod.internal.das/api/tes-6.5/postbody")
$combobox.SelectedIndex=0
$form.Controls.Add($combobox)

$label= New-Object System.Windows.Forms.Label
$label.Text="USERNAME"
$label.Location=New-Object System.Drawing.Point(10,40)
$label.Size = New-Object System.Drawing.Size(80,20)
$form.Controls.Add($label)


$label2= New-Object System.Windows.Forms.Label
$label2.Text="PASSWORD"
$label2.Location=New-Object System.Drawing.Point(10,60)
$label2.Size = New-Object System.Drawing.Size(80,20)
$form.Controls.Add($label2)



$textbox= New-Object System.Windows.Forms.TextBox
$textbox.Text="ENTER USERNAME"
$textbox.Location=New-Object System.Drawing.Point(100,40)
$textbox.Size = New-Object System.Drawing.Size(200,20)
$form.Controls.Add($textbox)
$textboxes.Add($textbox)

$textbox2= New-Object System.Windows.Forms.TextBox
$textbox2.Text="ENTER PASSWORD"
$textbox2.Location=New-Object System.Drawing.Point(100,60)
$textbox2.Size = New-Object System.Drawing.Size(200,20)
$form.Controls.Add($textbox2)




$textboxes.Add($textbox2)

$button=New-Object System.Windows.Forms.Button
$button.Text= "Extract"
$button.Location=New-Object System.Drawing.Point(150,100)
$button.Size = New-Object System.Drawing.Size(100,30)
$button.Add_Click({
$args= $textboxes | ForEach-Object{$_.Text}
[System.Windows.Forms.MessageBox]::Show("Arguments:$($args -join ',')","Arguments Submitted")})
$form.Controls.Add($button)
$form.ShowDialog()
